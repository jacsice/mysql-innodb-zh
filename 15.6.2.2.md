#### 15.6.2.2 The Physical Structure of an InnoDB Index



With the exception of spatial indexes, `InnoDB` indexes are [B-tree](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_b_tree) data structures. Spatial indexes use [R-trees](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_r_tree), which are specialized data structures for indexing multi-dimensional data. Index records are stored in the leaf pages of their B-tree or R-tree data structure. The default size of an index page is 16KB. The page size is determined by the [`innodb_page_size`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_page_size) setting when when the MySQL instance is initialized. See [Section 15.8.1, “InnoDB Startup Configuration”](https://dev.mysql.com/doc/refman/8.0/en/innodb-init-startup-configuration.html).

> 除了空间索引，`InnoDB` 索引是 [B-tree](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_b_tree) 数据结构。空间索引使用 [R-trees](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_r_tree)，这是多维数据使用索引的专用数据结构。索引记录存储在 B-tree或 R-tree数据结构的叶子节点中。索引页的默认大小为 16KB。页面大小由初始化 MySQL 实例时的 [`innodb_page_size`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_page_size) 设置确定

When new records are inserted into an `InnoDB` [clustered index](https://dev.mysql.com/doc/refman/8.0/en/glossary.html#glos_clustered_index), `InnoDB` tries to leave 1/16 of the page free for future insertions and updates of the index records. If index records are inserted in a sequential order (ascending or descending), the resulting index pages are about 15/16 full. If records are inserted in a random order, the pages are from 1/2 to 15/16 full.

> 当将新记录插入到 `InnoDB` 聚簇索引中时，`InnoDB` 尝试留下 1/16的页面供将来插入和更新索引记录。如果索引记录按顺序（升序或降序）插入，则生成的索引页大约填充15/16就满了。如果以随机顺序插入记录，则页面填充 1/2 到 15/16就满了。

`InnoDB` performs a bulk load when creating or rebuilding B-tree indexes. This method of index creation is known as a sorted index build. The [`innodb_fill_factor`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_fill_factor) variable defines the percentage of space on each B-tree page that is filled during a sorted index build, with the remaining space reserved for future index growth. Sorted index builds are not supported for spatial indexes. For more information, see [Section 15.6.2.3, “Sorted Index Builds”](https://dev.mysql.com/doc/refman/8.0/en/sorted-index-builds.html). An [`innodb_fill_factor`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_fill_factor) setting of 100 leaves 1/16 of the space in clustered index pages free for future index growth.

> `InnoDB` 在创建或重建 B-tree索引时执行批量加载。这种创建索引的方法称为排序索引构建。 [`innodb_fill_factor`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_fill_factor) 变量定义了排序索引构建时每个 B-tree页上填充的空间百分比，剩余空间保留用于未来索引增长。空间索引不支持排序索引构建。有关更多信息，请参阅 [第 15.6.2.3 节，“排序索引构建”](https://dev.mysql.com/doc/refman/8.0/en/sorted-index-builds.html)。将 [`innodb_fill_factor`](https://dev.mysql.com/doc/refman/8.0/en/innodb-parameters.html#sysvar_innodb_fill_factor) 设置为 100 后，聚簇索引页面中 1/16 的空间可供将来索引增长。

If the fill factor of an `InnoDB` index page drops below the `MERGE_THRESHOLD`, which is 50% by default if not specified, `InnoDB` tries to contract the index tree to free the page. The `MERGE_THRESHOLD` setting applies to both B-tree and R-tree indexes. For more information, see [Section 15.8.11, “Configuring the Merge Threshold for Index Pages”](https://dev.mysql.com/doc/refman/8.0/en/index-page-merge-threshold.html).

>如果 `InnoDB` 索引页面的填充因子低于 `MERGE_THRESHOLD`（如果未指定，则默认为 50%），`InnoDB` 会尝试收缩索引树以释放页面。 `MERGE_THRESHOLD` 设置适用于 B-tree 和 R-tree 索引。